generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native"]
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Admin {
  id           String   @id @default(uuid())
  name         String
  email        String   @unique
  phoneNumber  String?
  passwordHash String
  role         String   @default("admin")
  avatar       String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model Kid {
  id           String    @id @default(uuid())
  name         String
  email        String?   @unique
  fatherName   String?
  motherName   String?
  parentPhone  String?   @unique
  dateOfBirth  DateTime?
  passwordHash String?
  role         String    @default("kid")
  gender       String?
  avatar       String?
  isVerified   Boolean   @default(false)
  verificationCode String?
  verificationCodeExpires DateTime?
  lastLogin    DateTime?
  submissions  Submission[]
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
}

model Comic {
  id                 String       @id @default(uuid())
  title              String
  subtitle           String
  description        String
  image              String?
  category           String?
  submissionDeadline DateTime?
  bonus              Int          @default(0)
  totalMarks         Int          @default(0)
  maxUploads        Int          @default(1)
  document          String?
  submissions       Submission[]
  createdAt          DateTime     @default(now())
  updatedAt          DateTime     @updatedAt
}

model Submission {
  id             String   @id @default(uuid())
  kidId          String
  comicId        String
  kid            Kid      @relation(fields: [kidId], references: [id])
  comic          Comic    @relation(fields: [comicId], references: [id])
  marks          Int?
  description    String?
  files          String   // JSON array of file URLs
  comments       String?
  status         String   @default("pending") // e.g., pending, graded
  submissionDate DateTime @default(now())
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
}
